<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta itemprop="name" content="Deleting a Directory That Has a Trailing Space Shouldn&#39;t Be This Hard">
<meta itemprop="description" content="It shouldn&rsquo;t be this hard. This is a consumate #windowsmoment
If you occasionally use something like Robocopy, or other command line tool, it can be possible to create a directory with a trailing slash. For instance
robocopy &#34;C:\test\Taco&#34; &#34;C:\Burritos\are\delicious &#34; This trailing space would be actually used by Robocopy to initialize a directory that has a trailing space in the name. This can appear as a duplicator in explorer, until you try to rename and notice a trailing slash.">


<meta itemprop="datePublished" content="2018-07-23T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-07-23T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="293">



<meta itemprop="keywords" content="tech,powershell," />
<meta property="og:title" content="Deleting a Directory That Has a Trailing Space Shouldn&#39;t Be This Hard" />
<meta property="og:description" content="It shouldn&rsquo;t be this hard. This is a consumate #windowsmoment
If you occasionally use something like Robocopy, or other command line tool, it can be possible to create a directory with a trailing slash. For instance
robocopy &#34;C:\test\Taco&#34; &#34;C:\Burritos\are\delicious &#34; This trailing space would be actually used by Robocopy to initialize a directory that has a trailing space in the name. This can appear as a duplicator in explorer, until you try to rename and notice a trailing slash." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sheldonhull.com/blog/2018-07-23-deleting-a-directory-that-has-a-trailing-space-shouldn-t-be-this-hard/" />
<meta property="article:published_time" content="2018-07-23T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-07-23T00:00:00&#43;00:00"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deleting a Directory That Has a Trailing Space Shouldn&#39;t Be This Hard"/>
<meta name="twitter:description" content="It shouldn&rsquo;t be this hard. This is a consumate #windowsmoment
If you occasionally use something like Robocopy, or other command line tool, it can be possible to create a directory with a trailing slash. For instance
robocopy &#34;C:\test\Taco&#34; &#34;C:\Burritos\are\delicious &#34; This trailing space would be actually used by Robocopy to initialize a directory that has a trailing space in the name. This can appear as a duplicator in explorer, until you try to rename and notice a trailing slash."/>

	<link rel="apple-touch-icon" sizes="180x180" href="https://www.sheldonhull.com/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://www.sheldonhull.com/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://www.sheldonhull.com/favicon-16x16.png">
	<link rel="manifest" href="https://www.sheldonhull.com/site.webmanifest">
	<link rel="mask-icon" href="https://www.sheldonhull.com/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="https://www.sheldonhull.com/favicon.ico">

	<title>Deleting a Directory That Has a Trailing Space Shouldn&#39;t Be This Hard</title>
	<link rel="stylesheet" href="https://www.sheldonhull.com/css/style.min.31706917653d2b9e8410abd431f30ec4359a88a94fc87a63654779d87329edec.css" integrity="sha256-MXBpF2U9K56EEKvUMfMOxDWaiKlPyHpjZUd52HMp7ew=">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://www.sheldonhull.com">sheldonhull.com</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					<a href="https://www.sheldonhull.com/blog/">Blog</a>
					<a href="https://www.sheldonhull.com/docs/">Docs</a>
					<a href="https://www.sheldonhull.com/tags/">Tags</a>
					<a href="https://www.sheldonhull.com/about/">About</a>
				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://www.sheldonhull.com/blog/">Blog</a></li>
			<li><a href="https://www.sheldonhull.com/docs/">Docs</a></li>
			<li><a href="https://www.sheldonhull.com/tags/">Tags</a></li>
			<li><a href="https://www.sheldonhull.com/about/">About</a></li>
		</ul>
	</div>


	<main class="site-main section-inner thin animated fadeIn faster">
		<h1>Deleting a Directory That Has a Trailing Space Shouldn&#39;t Be This Hard</h1>
		<div class="content">
			<p>It shouldn&rsquo;t be this hard. This is a consumate #windowsmoment</p>

<p><img src="https://www.sheldonhull.com/assets/img/ConEmu64_2018-07-23_11-42-59 - Copy.png" alt="Removing Folder Fails" /></p>

<p>If you occasionally use something like Robocopy, or other command line tool, it can be possible to create a directory with a trailing slash. For instance</p>
<div class="highlight"><pre class="chroma"><code class="language-cmd" data-lang="cmd">robocopy <span class="s2">&#34;C:\test\Taco&#34;</span> <span class="s2">&#34;C:\Burritos\are\delicious &#34;</span></code></pre></div>
<p>This trailing space would be actually used by Robocopy to initialize a directory that has a trailing space in the name. This can appear as a duplicator in explorer, until you try to rename and notice a trailing slash. Attempts to rename, delete, or perform any activity to manipulate this directory fail as Windows indicates that it can&rsquo;t find the directory as it no longer exists or might have been moved.</p>

<p>To resolve this I found details on SO about how to delete in response to the question <a href="https://stackoverflow.com/a/21074385">&ldquo;Can&rsquo;t Delete a Folder on Windows 7 With a Trailing Space&rdquo;</a>.</p>

<p>Apparently it&rsquo;s an issue with NFTS handling. To resolve you have to use cmd.exe to <code>rd</code> (remove directory), and change your path to a UNC path referring to your local path.</p>

<p>To resolve the error then you&rsquo;d do:</p>
<div class="highlight"><pre class="chroma"><code class="language-cmd" data-lang="cmd">rm \\?\C:\Burritos\are\delicious</code></pre></div>
<p>To confirm that PowerShell can&rsquo;t resolve this I did a quick test by running:</p>
<div class="highlight"><pre class="chroma"><code class="language-cmd" data-lang="cmd"><span class="k">cd</span> C<span class="p">:</span><span class="nl">\temp</span>
<span class="k">md</span> <span class="s2">&#34;.\ Taco &#34;</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Fails - No error</span>
<span class="nb">remove-item</span> <span class="s2">&#34;\\?\C:\temp\taco &#34;</span>

<span class="c"># Fails with error: Remove-Item : Cannot find path &#39;\\localhost\c$\temp\taco &#39; because it does not exist.</span>
<span class="nv">$verbosepreference</span> <span class="p">=</span> <span class="s1">&#39;continue&#39;</span><span class="p">;</span> <span class="nb">Remove-Item</span> <span class="s2">&#34;\\localhost\c$\temp\taco &#34;</span>

<span class="c"># SUCCESS: Succeeds to remove it</span>
<span class="n">GCI</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">Temp</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span> <span class="o">-match</span> <span class="s1">&#39;taco&#39;</span><span class="p">}</span> <span class="p">|</span> <span class="nb">Remove-Item</span></code></pre></div>
<p>So for me, I wanted to confirm that PowerShell was truly unable to resolve the issue without resorting to cmd.exe for this. Turns out it can, but you need to pass the matched object in, not expect it to match the filepath directly.</p>

<p>Now to go eat some tacos&hellip;.</p>

		</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2019 <a href="https://www.sheldonhull.com"></a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://www.sheldonhull.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>


	<script src="https://www.sheldonhull.com/js/main.min.784417f5847151f848c339cf0acb13a06cbb648b1483435a28ed4556c4ead69b.js" integrity="sha256-eEQX9YRxUfhIwznPCssToGy7ZIsUg0NaKO1FVsTq1ps="></script>

</body>

</html>
