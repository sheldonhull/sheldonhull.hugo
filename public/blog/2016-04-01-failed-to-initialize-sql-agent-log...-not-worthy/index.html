<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta itemprop="name" content="Failed to Initialize SQL Agent Log... not worthy">
<meta itemprop="description" content="Moving system databases in SQL Server takes a bit of practice. I got that again, along with a dose of SQL humility (so tasty!), today after messing up some cleanup with sql agent server log files.
Failed to initialize SQL Agent log (reason: Access is denied). I was creating a sql template when this came about. SQL Server Agent wouldn&rsquo;t start back up despite all the system databases having very little issues with my somewhat brilliant sql commands.">


<meta itemprop="datePublished" content="2016-04-01T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2016-04-01T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="237">



<meta itemprop="keywords" content="sql-server," />
<meta property="og:title" content="Failed to Initialize SQL Agent Log... not worthy" />
<meta property="og:description" content="Moving system databases in SQL Server takes a bit of practice. I got that again, along with a dose of SQL humility (so tasty!), today after messing up some cleanup with sql agent server log files.
Failed to initialize SQL Agent log (reason: Access is denied). I was creating a sql template when this came about. SQL Server Agent wouldn&rsquo;t start back up despite all the system databases having very little issues with my somewhat brilliant sql commands." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sheldonhull.com/blog/2016-04-01-failed-to-initialize-sql-agent-log...-not-worthy/" />
<meta property="article:published_time" content="2016-04-01T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2016-04-01T00:00:00&#43;00:00"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Failed to Initialize SQL Agent Log... not worthy"/>
<meta name="twitter:description" content="Moving system databases in SQL Server takes a bit of practice. I got that again, along with a dose of SQL humility (so tasty!), today after messing up some cleanup with sql agent server log files.
Failed to initialize SQL Agent log (reason: Access is denied). I was creating a sql template when this came about. SQL Server Agent wouldn&rsquo;t start back up despite all the system databases having very little issues with my somewhat brilliant sql commands."/>

	<link rel="apple-touch-icon" sizes="180x180" href="https://www.sheldonhull.com/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://www.sheldonhull.com/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://www.sheldonhull.com/favicon-16x16.png">
	<link rel="manifest" href="https://www.sheldonhull.com/site.webmanifest">
	<link rel="mask-icon" href="https://www.sheldonhull.com/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="https://www.sheldonhull.com/favicon.ico">

	<title>Failed to Initialize SQL Agent Log... not worthy</title>
	<link rel="stylesheet" href="https://www.sheldonhull.com/css/style.min.31706917653d2b9e8410abd431f30ec4359a88a94fc87a63654779d87329edec.css" integrity="sha256-MXBpF2U9K56EEKvUMfMOxDWaiKlPyHpjZUd52HMp7ew=">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://www.sheldonhull.com">sheldonhull.com</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					<a href="https://www.sheldonhull.com/blog/">Blog</a>
					<a href="https://www.sheldonhull.com/docs/">Docs</a>
					<a href="https://www.sheldonhull.com/tags/">Tags</a>
					<a href="https://www.sheldonhull.com/about/">About</a>
				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://www.sheldonhull.com/blog/">Blog</a></li>
			<li><a href="https://www.sheldonhull.com/docs/">Docs</a></li>
			<li><a href="https://www.sheldonhull.com/tags/">Tags</a></li>
			<li><a href="https://www.sheldonhull.com/about/">About</a></li>
		</ul>
	</div>


	<main class="site-main section-inner thin animated fadeIn faster">
		<h1>Failed to Initialize SQL Agent Log... not worthy</h1>
		<div class="content">
			<p>Moving system databases in SQL Server takes a bit of practice. I got that again, along with a dose of SQL humility (so tasty!), today after messing up some cleanup with sql agent server log files.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">Failed to initialize SQL Agent log (reason: Access is denied).</code></pre></div>
<p>I was creating a sql template when this came about. SQL Server Agent wouldn&rsquo;t start back up despite all the system databases having very little issues with my somewhat brilliant sql commands.
I had moved all my databases to the new drive location, and changed the advanced startup parameters for sql server and SQL Agent&hellip; or so I thought.</p>

<p><img src="https://www.sheldonhull.com/assets/img/2016-04-01_18-20-41.png" alt="Logging location not the same" /></p>

<p>I apparently missed the order of operations with SQL Server Agent, and so it was unable to start. MSDN actually says to go into the SQL agent in SSMS to change this, and I thought I was smarter than msdn&hellip;.</p>

<blockquote>
<p><a href="https://msdn.microsoft.com/en-us/library/ms345408.aspx">MSDN</a></p>

<ul>
<li>Change the SQL Server Agent Log Path
From SQL Server Management Studio, in Object Explorer, expand SQL Server Agent.</li>
<li>Right-click Error Logs and click Configure.</li>
<li>In the Configure SQL Server Agent Error Logs dialog box, specify the new location of the SQLAGENT.OUT file.</li>
<li>The default location is C:\Program Files\Microsoft SQL Server\MSSQL
<version data-preserve-html-node="true">.
<instance_name data-preserve-html-node="true">\MSSQL\Log.
Found the registry entry and changed here&hellip; all fixed!</instance_name></version></li>
</ul>
</blockquote>

<p><img src="https://www.sheldonhull.com/assets/img/2016-04-01_18-16-31.png" alt="Fixing in the registry" />
I also updated the WorkDirectoryEntry to ensure it matched new paths.</p>

<p>Thanks to this <a href="https://blogs.msdn.microsoft.com/sqlserverfaq/2009/06/12/unable-to-start-sql-server-agent/">article</a> I was saved some headache. I also learned to read directions more carefully :-)</p>

		</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2019 <a href="https://www.sheldonhull.com"></a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://www.sheldonhull.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>


	<script src="https://www.sheldonhull.com/js/main.min.784417f5847151f848c339cf0acb13a06cbb648b1483435a28ed4556c4ead69b.js" integrity="sha256-eEQX9YRxUfhIwznPCssToGy7ZIsUg0NaKO1FVsTq1ps="></script>

</body>

</html>
