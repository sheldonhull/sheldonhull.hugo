---
date: 2021-08-03T14:32:30-05:00
title: Go R1 Day 61
slug: go-r1-day-61
area: go
round: 1
day_counter: 61
tags:
- tech
- development
- 100DaysOfCode
- golang
- microblog
typora-root-url: ../../../static
typora-copy-images-to:  ../../../static/images

images: [/images/2021-08-03-the-wizard-vs-compiler.jpeg]

---

## progress

It was a dark and stormy night.
The world was bleak.
A command was sent to The Compiler.

The assumptions were flawed.
The command was rejected.

> You have given me an invalid command with `-argument-that-shall-not-work 5` being invalid.

But I've provided `--argument-that-shall-not-work`, the indomitable wizard said.

> Your command is unworthy.

Digging into esoteric tomes of knowledge, the wizard discovered others have had similar issues when calling external processes using the legendary wizardry of `os/exec`.
However, none could shine light into the darkness of his failure.

Running in `pwsh` worked fine.

Next, the wizard tried a variety of escaping commands.

- Using `shellescape` package.
- Using back-ticks with the arguments to escape.
- Using partially quoted arguments in the slice of the strings.
- Using no quotes.

To the wizards dismay, copying the printed debug output worked fine in the terminal, but alas would not be executed by The Compiler.

This was beginning to feel much like dealing with dynamic SQL and the pain of arguments.

The wizard ruminated on his plight and thought: "At the end of the day, all things seem to come down to strings and the cursed interpretation of my textual commands to The Compiler. How many a day have I wasteth upon the fault of a single character. The root of all evil must be a string."

The wizard connected to the remote ssh instance that VSCode provided a portal into, enabled custom debug settings and passed in the arguments.

The debug breakpoint config that worked...

```json
  {
      "name": "Run frustrating-test",
      "type": "go",
      "request": "launch",
      "mode": "debug",
      "program": "${workspaceFolder}/MyTestApp/test.go",
      "args": [
        "-count",
        "100",
        "-batch",
        "10",
        "-delay",
        "1",
        "-server",
        "MyCustomIPAddress",
        "-debug",
      ],
      "debugAdapter": "legacy" // newer version wouldn't work remote
    },
```

Consulting The Sage (aka Debugger), it advised the wizard of the message sent to The Compiler.

![Debug Variables](/images/2021-08-03-14.52.18-debug-variables.png "Debug Variables")

The wizard had a revelation of applying the simplest of concepts based on results from another skilled magicians insight.

Instead of apply the arguments in the following manner:

```go
command = append(command, fmt.Sprintf(`--header "user-id: %s"`, petname.Generate(petNameLength, "-"))
```

the approach would be to break the arguments into individual lines.

```go
command = append(command, "--header")
command = append(command, fmt.Sprintf(`user-id: %s`, petname.Generate(petNameLength, "-")))
command = append(command, "--max-retry-count", "5")
```

The foe vanquished, the _The Blight of Strings_ was cast aside with malice.
The wizard swore to never fall prey to this again.

The Compiler's heartless gaze felt nothing.
In the shadows, _The String Balrock_ bid it's time, knowing that the wizard would suffer once again.

![It Works](/images/2021-08-03-goroutine.gif "It Works")