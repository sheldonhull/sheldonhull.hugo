

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <title>Working With Powershell Objects to Create Yaml - sheldonhull.com</title><meta name="Description" content="A personal dev blog"><meta property="og:title" content="Working With Powershell Objects to Create Yaml" />
<meta property="og:description" content="Here&rsquo;s a walk-through on using PowerShell objects to dynamically generate yaml configuration files." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sheldonhull.com/working-with-powershell-objects-to-create-yaml/" /><meta property="og:image" content="https://www.sheldonhull.com/images/sheldon-avatar.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-09T05:30:39+00:00" />
<meta property="article:modified_time" content="2025-06-28T13:45:36-05:00" />


<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://www.sheldonhull.com/images/sheldon-avatar.jpg" /><meta name="twitter:title" content="Working With Powershell Objects to Create Yaml"/>
<meta name="twitter:description" content="Here&rsquo;s a walk-through on using PowerShell objects to dynamically generate yaml configuration files."/>
<meta name="twitter:site" content="@sheldon_hull"/>
<meta name="application-name" content="sheldonhull.com">
<meta name="apple-mobile-web-app-title" content="sheldonhull.com">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><meta name="twitter:creator" content="@sheldon_hull" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<link rel="canonical" href="https://www.sheldonhull.com/working-with-powershell-objects-to-create-yaml/" /><link rel="prev" href="https://www.sheldonhull.com/nativefier/" /><link rel="next" href="https://www.sheldonhull.com/incremental-and-consistent/" />
<link rel="stylesheet" href="/css/main.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">{"@context": "https://schema.org","@type": "BlogPosting",
        "headline": "Working With Powershell Objects to Create Yaml",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://www.sheldonhull.com/working-with-powershell-objects-to-create-yaml/"
        },"image": ["https://www.sheldonhull.com/images/sheldon-avatar.jpg"],"genre": "posts","keywords":["development","tech","powershell","devops"],"wordcount":  1779 ,
        "url": "https://www.sheldonhull.com/working-with-powershell-objects-to-create-yaml/","datePublished": "2021-02-09T05:30:39+00:00","dateModified": "2025-06-28T13:45:36-05:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https://www.sheldonhull.com/images/sheldon-avatar.jpg"},"author": {
                "@type": "Person",
                "name": "Author",
                "url": "/"
            },"description": ""
    }</script>
    

  
<script src="/jslibs/turbo/v7/index.75da65174eac2f7420dfff4e943b2459d6557d149518d5f6162d08d48842b1e8.js"  integrity="sha256-ddplF06sL3Qg3/9OlDskWdZVfRSVGNX2Fi0I1IhCseg="  defer></script>

        <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "2b4de99e93dc485baaf20c6dffaf78a0"}'></script>
        <link rel="webmention" href="https://webmention.io/www.sheldonhull.com/webmention" />
        <link rel="pingback" href="https://webmention.io/www.sheldonhull.com/xmlrpc" />

    

    <a class="h-card" rel="me" href="https://www.sheldonhull.com/"></a>



</head>
    
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop print:!tw-hidden" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="sheldonhull.com"><img
        class="logo"
        loading="lazy"
        src="/images/sheldon-avatar.jpg"
        srcset="/images/sheldon-avatar.jpg, /images/sheldon-avatar.jpg 1.5x, /images/sheldon-avatar.jpg 2x"
        title="/images/sheldon-avatar.jpg" height="36"   width="36" ><span class="header-title-pre"><span id="logo-anima"><span class="arrow">></span><span class="dash">_</span></span></span><span id="desktop-header-typeit" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item"
                    href="/posts" > posts </a><a class="menu-item"
                    href="/archive" > archive </a><a class="menu-item"
                    href="/about/" > about </a><a class="menu-item"
                    href="/notes/" > notes </a><a class="menu-item"
                    href="/creative/" > creative </a><a class="menu-item"
                    href="/tags/" > tags </a><a class="menu-item"
                    href="https://github.com/sheldonhull/"  title="GitHub" 
                    rel="noopener noreferrer" target="_blank" ><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                    <input type="text"
                        placeholder="Search titles or contents..."
                        id="search-input-desktop">
                    <button class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
                    </button>
                    <button class="search-button search-clear" id="search-clear-desktop" title="Clear">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>
                    </button>
                    <span class="search-button search-loading tw-animate-spin" id="search-loading-desktop">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"/></svg>
                    </span>
                </span><button class="menu-item theme-switch" aria-label="Switch Theme">
                    <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
                </button></div>
        </div>
    </div>
</header><header class="mobile print:!tw-hidden" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="sheldonhull.com"><img
        class="logo"
        loading="lazy"
        src="/images/sheldon-avatar.jpg"
        srcset="/images/sheldon-avatar.jpg, /images/sheldon-avatar.jpg 1.5x, /images/sheldon-avatar.jpg 2x"
        title="/images/sheldon-avatar.jpg" ><span class="header-title-pre"><span id="logo-anima"><span class="arrow">></span><span class="dash">_</span></span></span><span id="mobile-header-typeit" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                <div class="search mobile" id="search-mobile">
                    <input type="text"
                        placeholder="Search titles or contents..."
                        id="search-input-mobile">
                    <button class="search-button search-toggle tw-h-10" id="search-toggle-mobile" title="Search">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
                    </button>
                    <button class="search-button search-clear" id="search-clear-mobile" title="Clear">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>
                    </button>
                    <span class="search-button search-loading tw-animate-spin" id="search-loading-mobile">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"/></svg>
                    </span>
                </div>
                <button class="search-cancel" id="search-cancel-mobile">
                    Cancel
                </button>
            </div><a class="menu-item" href="/posts" title="" >posts</a><a class="menu-item" href="/archive" title="" >archive</a><a class="menu-item" href="/about/" title="" >about</a><a class="menu-item" href="/notes/" title="" >notes</a><a class="menu-item" href="/creative/" title="" >creative</a><a class="menu-item" href="/tags/" title="" >tags</a><a class="menu-item" href="https://github.com/sheldonhull/" title="GitHub" 
                rel="noopener noreferrer" target="_blank" ><i class='fab fa-github fa-fw'></i></a><button class="menu-item theme-switch tw-w-full" aria-label="Switch Theme">
                <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
            </button></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
                <div class="container"><article class="page single h-entry"><h1 class="single-title animated flipInX p-name">Working With Powershell Objects to Create Yaml</h1><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><a href="/" title="Author" rel=" author" class="author">Author</a>
       </span></div>
      <div class="post-meta-line">
        <a
          rel="author"
          class="p-author h-card"
          style="display: none;"
          ref="https://www.sheldonhull.com/"
        >
          
        </a>
        <span class="u-url" style="display: none;">https://www.sheldonhull.com/working-with-powershell-objects-to-create-yaml/</span>
        <span class="dt-published" style="display: none;">
          2021-02-09T05:30:39Z
        </span><i class="far fa-calendar-alt fa-fw"></i>
          &nbsp;
          <time datetime="2021-02-09">2021-02-09</time>
          &nbsp;<i class="fas fa-pencil-alt fa-fw"></i>
        &nbsp;1779 words&nbsp;
        <i class="far fa-clock fa-fw"></i>
        &nbsp;9 minutes&nbsp;</div>
    </div>
    


<div class="content e-content" id="content"><h2 id="who-this-might-be-for" class="headerLink">
    <a href="#who-this-might-be-for" class="header-mark"></a>Who This Might Be For</h2><ul>
<li>PowerShellers wanting to know how to create json and yaml dynamically via <code>pscustomobject</code>.</li>
<li>Anyone wanting to create configs like Datadog or other tools dynamically without the benefit of a configuration management tool.</li>
<li>Anyone else wanting to fall asleep more quickly. (I can think of better material such as the Go spec docs, but hey, I can&rsquo;t argue with your good taste ðŸ˜„)</li>
</ul>
<h2 id="yaml" class="headerLink">
    <a href="#yaml" class="header-mark"></a>YAML</h2><p>It&rsquo;s readable.</p>
<p>It&rsquo;s probably cost all of us hours when debugging yaml that&rsquo;s nested several layers and an errant whitespace got in.</p>
<p>It&rsquo;s here to stay.</p>
<p>I prefer it over JSON for readability, but I prefer JSON for programmability.</p>
<p>Sometimes though, tooling uses yaml, and we need to be able to flip between both.</p>
<p>Historically I&rsquo;ve used <code>cfn-flip</code> which is pretty great.</p>
<h2 id="enter-yq" class="headerLink">
    <a href="#enter-yq" class="header-mark"></a>Enter yq</h2><p>The problem I have with using <code>cfn-flip</code> is dependencies.
It&rsquo;s a bit crazy to setup a docker image and then need to install a bunch of python setup tools to just get this one tool when it&rsquo;s all I need.</p>
<p>I thought about building a quick <code>Go</code> app to do this and give me the benefit of a single binary, as there is a pretty useful <code>yaml</code> package already.
Instead, I found a robust package that is cross-platform called <code>yq</code> and it&rsquo;s my new go to. ðŸŽ‰</p>
<h2 id="just-plain-works" class="headerLink">
    <a href="#just-plain-works" class="header-mark"></a>Just plain works</h2><p><a href="http://bit.ly/3pphpTb" target="_blank" rel="noopener noreferrer">The docs are great</a></p>
<p>Reading <code>STDIN</code> is a bit clunky, but not too bad, though I wish it would take more of a pipeline input approach natively.
Instead of passing in <code>{&quot;string&quot;:&quot;value&quot;} | yq</code> it requires you to specify <code>stringinput | yq eval - --prettyPrint</code> .
Note the single hyphen after eval. This is what signifies that the input is <code>STDIN</code>.</p>
<h2 id="dynamically-generate-some-configs" class="headerLink">
    <a href="#dynamically-generate-some-configs" class="header-mark"></a>Dynamically Generate Some Configs</h2><p>I was working on some Datadog config generation for SQL Server, and found this tooling useful, especially on older Windows instances that didn&rsquo;t have the capability to run the nice module <a href="http://bit.ly/3j4D94J" target="_blank" rel="noopener noreferrer">powershell-yaml</a>.</p>
<p>Here&rsquo;s how to use PowerShell objects to help generate a yaml configuration file on demand.</p>
<h3 id="install" class="headerLink">
    <a href="#install" class="header-mark"></a>Install</h3><p>See install directions for linux/mac, as it&rsquo;s pretty straightforward.</p>
<p>For windows, the chocolatey package was outdated as of the time of the article using the version 3.x.</p>
<p>I used a PowerShell 4.0 compatible syntax here that should work on any instances with access to the web.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">[</span><span class="no">Net.ServicePointManager</span><span class="p">]::</span><span class="n">SecurityProtocol</span> <span class="p">=</span> <span class="p">[</span><span class="no">Net.SecurityProtocolType</span><span class="p">]::</span><span class="n">Tls12</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">-PathType</span> <span class="n">Leaf</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$ProgressPreference</span> <span class="p">=</span> <span class="s1">&#39;SilentlyContinue&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">New-Item</span> <span class="s1">&#39;C:\tools&#39;</span> <span class="n">-ItemType</span> <span class="n">Directory</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Invoke-WebRequest</span> <span class="s1">&#39;https://github.com/mikefarah/yq/releases/download/v4.4.1/yq_windows_amd64.exe&#39;</span> <span class="n">-OutFile</span> <span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">-UseBasicParsing</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Unblock-File</span> <span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">-Confirm:</span><span class="vm">$false</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Once this was downloaded, you could either make sure <code>C:\tools</code> was in <code>PATH</code> or just use the fully qualified path for our simple use case.</p>
<h3 id="get-aws-metadata" class="headerLink">
    <a href="#get-aws-metadata" class="header-mark"></a>Get AWS Metadata</h3><p>In AWS, I parsed the metadata for the AccountID and InstanceID to generate a query to pull the Name tag dynamically.</p>
<div
    class="details admonition Tip
      open
    "
  >
    <div class="details-summary admonition-title">
      <i
        class="icon fas fa-pencil-alt fa-fw"
      ></i>
      Permissions Check
      <i class="details-icon fas fa-angle-right fa-fw"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">You must have the required permissions for the instance profile for this to work.
This is not an instance level permission, so you&rsquo;ll want to add the required DescribeTags and ListInstances permissions for using a command such as <code>Get-EC2Tag</code></div>
    </div>
  </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Import-Module</span> <span class="n">AWSPowershell</span> <span class="n">-Verbose:</span><span class="vm">$false</span> <span class="p">*&gt;</span> <span class="vm">$null</span>
</span></span><span class="line"><span class="cl"><span class="c"># AWSPowerShell is the legacy module, but is provided already on most AWS instances</span>
</span></span><span class="line"><span class="cl"><span class="nv">$response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="s1">&#39;http://169.254.169.254/latest/dynamic/instance-identity/document&#39;</span> <span class="n">-TimeoutSec</span> <span class="mf">5</span>
</span></span><span class="line"><span class="cl"><span class="nv">$AccountId</span> <span class="p">=</span> <span class="nv">$response</span><span class="p">.</span><span class="py">AccountId</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pull-back-ec2-tags" class="headerLink">
    <a href="#pull-back-ec2-tags" class="header-mark"></a>Pull Back EC2 Tags</h3><p>Now we can pull back the tag using an EC2 instance filter object.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$filters</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="no">Amazon.EC2.Model.Filter</span><span class="p">]::</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;resource-id&#39;</span><span class="p">,</span> <span class="nv">$response</span><span class="p">.</span><span class="n">InstanceId</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$tags</span> <span class="p">=</span> <span class="nb">Get-EC2Tag</span> <span class="n">-Filters</span> <span class="nv">$filters</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$tagcollection</span> <span class="p">=</span> <span class="nv">$tags</span><span class="p">.</span><span class="k">ForEach</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$t</span> <span class="p">=</span> <span class="nv">$_</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="no">pscustomobject</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">Name</span>  <span class="p">=</span> <span class="nv">$t</span><span class="p">.</span><span class="py">name</span>
</span></span><span class="line"><span class="cl">          <span class="n">Value</span> <span class="p">=</span> <span class="nv">$t</span><span class="p">.</span><span class="py">value</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nb">Write-Host</span> <span class="s2">&#34;Tags For Instance: </span><span class="p">$(</span><span class="nv">$tagcollection</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-AutoSize</span> <span class="n">-Wrap</span> <span class="p">|</span> <span class="nb">Out-String</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$HostName</span> <span class="p">=</span> <span class="nv">$Tags</span><span class="p">.</span><span class="py">GetEnumerator</span><span class="p">().</span><span class="py">Where</span><span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">Key</span> <span class="o">-eq</span> <span class="s1">&#39;Name&#39;</span> <span class="p">}.</span><span class="n">Value</span><span class="p">.</span><span class="py">ToLower</span><span class="p">().</span><span class="py">Trim</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$SqlInstance</span> <span class="p">=</span> <span class="nv">$HostName</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="switch-things-up-with-a-switch" class="headerLink">
    <a href="#switch-things-up-with-a-switch" class="header-mark"></a>Switch Things Up With A Switch</h3><p>The next step was to alias the instance.</p>
<p>The better way to do this would be to use a tag that it reads, but for my quick ad-hoc use, this just let me specific an explicit alias to generate as a tag in the yaml. Again, try to use the Datadog tagging feature to do this automatically if possible.</p>
<div
    class="details admonition Tip
      open
    "
  >
    <div class="details-summary admonition-title">
      <i
        class="icon fas fa-pencil-alt fa-fw"
      ></i>
      Switch Statements
      <i class="details-icon fas fa-angle-right fa-fw"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>If you aren&rsquo;t familiar with PowerShell&rsquo;s switch statement, it&rsquo;s a nice little feature for making this evaluation easy to read.</p>
<p>For the breadth of what this cool language feature can do, check this article out:</p>
<p><a href="http://bit.ly/3pwnei0" target="_blank" rel="noopener noreferrer">Everything you ever wanted to know about the switch statement</a></p>
</div>
    </div>
  </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="k">switch</span> <span class="p">(</span><span class="nv">$AccountId</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;12345&#39;</span> <span class="p">{</span> <span class="nv">$AWSAccountAlias</span>  <span class="p">=</span> <span class="s1">&#39;mydevenv&#39;</span> <span class="p">;</span> <span class="nv">$stage</span> <span class="p">=</span> <span class="s1">&#39;qa&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;12345&#39;</span> <span class="p">{</span> <span class="nv">$AWSAccountAlias</span>  <span class="p">=</span> <span class="s1">&#39;myprodenv&#39;</span> <span class="p">;</span> <span class="nv">$stage</span> <span class="p">=</span> <span class="s1">&#39;prod&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="s2">&#34;Couldn&#39;t match a valid account number to give this an alias&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now, preview the results of this Frankenstein.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Write-Host</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span> <span class="p">(</span><span class="s2">&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2"></span><span class="se">`$</span><span class="s2">HostName        = </span><span class="nv">$HostName</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"></span><span class="se">`$</span><span class="s2">SqlInstance     = </span><span class="nv">$SqlInstance</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"></span><span class="se">`$</span><span class="s2">AWSAccountAlias = </span><span class="nv">$AWSAccountAlias</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"></span><span class="se">`$</span><span class="s2">stage           = </span><span class="nv">$stage</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"> &#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ready-to-generate-some-yaml-magic" class="headerLink">
    <a href="#ready-to-generate-some-yaml-magic" class="header-mark"></a>Ready To Generate Some Yaml Magic</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$TargetConfig</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Join-Path</span> <span class="nv">$ENV:ProgramData</span> <span class="s1">&#39;Datadog/conf.d/windows_service.d/conf.yaml&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Services</span> <span class="p">=</span> <span class="p">[</span><span class="no">pscustomobject</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;instances&#39;</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;services&#39;</span>                   <span class="p">=</span>  <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;SQLSERVERAGENT&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;MSSQLSERVER&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;SQLSERVERAGENT&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;disable_legacy_service_tag&#39;</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;tags&#39;</span>                       <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;aws_account_alias:</span><span class="nv">$AWSAccountAlias</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;sql_instance:</span><span class="nv">$SqlInstance</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;stage:</span><span class="nv">$stage</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$Services</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="mf">100</span> <span class="p">|</span> <span class="p">&amp;</span><span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">eval</span> <span class="p">-</span> <span class="p">-</span><span class="n">-prettyPrint</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$TargetConfig</span> <span class="n">-Encoding</span> <span class="n">UTF8</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This would produce a nice json output like this</p>
<p><figure><a class="lightgallery" href="/images/2021-02-08-yaml-config-example.png" title="Example config image" data-thumbnail="/images/2021-02-08-yaml-config-example.png">
        <img
            
            loading="lazy"
            src="/images/2021-02-08-yaml-config-example.png"
            srcset="/images/2021-02-08-yaml-config-example.png, /images/2021-02-08-yaml-config-example.png 1.5x, /images/2021-02-08-yaml-config-example.png 2x"
            alt="Example config image">
    </a></figure></p>
<h3 id="one-more-complex-example" class="headerLink">
    <a href="#one-more-complex-example" class="header-mark"></a>One More Complex Example</h3><p>Start with creating an empty array and some variables to work with.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$UserName</span> <span class="p">=</span> <span class="s1">&#39;TacoBear&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Password</span> <span class="p">=</span> <span class="s1">&#39;YouReallyThinkI&#39;&#39;dPostThis?Funny&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$TargetConfig</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Join-Path</span> <span class="nv">$ENV:ProgramData</span> <span class="s1">&#39;Datadog/conf.d/sqlserver.d/conf.yaml&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Queries</span> <span class="p">=</span> <span class="vm">@</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Next include the generic Datadog collector definition.</p>
<p>This is straight outta their <a href="http://bit.ly/3cisxgY" target="_blank" rel="noopener noreferrer">Github repo</a> with the benefit of some tagging.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$Queries</span> <span class="p">+=</span> <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;host&#39;</span>      <span class="p">=</span><span class="s1">&#39;tcp:localhost,1433&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;username&#39;</span>  <span class="p">=</span><span class="nv">$UserName</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;password&#39;</span>  <span class="p">=</span> <span class="nv">$Password</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;connector&#39;</span> <span class="p">=</span><span class="s1">&#39;adodbapi&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;driver&#39;</span>    <span class="p">=</span> <span class="s1">&#39;SQL Server&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;database&#39;</span>  <span class="p">=</span> <span class="s1">&#39;master&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;tags&#39;</span>      <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;aws_account_alias:</span><span class="nv">$AWSAccountAlias</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;sql_instance:</span><span class="nv">$SqlInstance</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;stage:</span><span class="nv">$stage</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div
    class="details admonition Tip
      open
    "
  >
    <div class="details-summary admonition-title">
      <i
        class="icon fas fa-pencil-alt fa-fw"
      ></i>
      Using &#43;= for Collections
      <i class="details-icon fas fa-angle-right fa-fw"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>Using <code>+=</code> is a bit of an anti-pattern for high performance PowerShell, but it works great for something like this that&rsquo;s ad-hoc and needs to be simple.
For high performance needs, try using something like <code>$list = [Systems.Collections.Generic.List[pscustomobject]]:new()</code> for example.
This can then allow you to use the <code>$list.Add([pscustomobject]@{}</code> to add items.</p>
<p>A bit more complex, but very powerful and performance, with the benefit of stronger data typing.</p>
</div>
    </div>
  </div>
<p>This one is a good example of the custom query format that Datadog supports, but honestly I found pretty confusing in their docs until I bumbled my way through a few iterations.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$Queries</span> <span class="p">+=</span>    <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c"># description: Not Used by Datadog, but helpful to reading the yaml, be kind to those folks!</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;description&#39;</span>             <span class="p">=</span> <span class="s1">&#39;Get Count of Databases on Server&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;host&#39;</span>                    <span class="p">=</span><span class="s1">&#39;tcp:localhost,1433&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;username&#39;</span>                <span class="p">=</span> <span class="nv">$UserName</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;database&#39;</span>                <span class="p">=</span> <span class="s1">&#39;master&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;password&#39;</span>                <span class="p">=</span> <span class="nv">$Password</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;connector&#39;</span>               <span class="p">=</span><span class="s1">&#39;adodbapi&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;driver&#39;</span>                  <span class="p">=</span> <span class="s1">&#39;SQL Server&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;min_collection_interval&#39;</span> <span class="p">=</span> <span class="p">[</span><span class="no">timespan</span><span class="p">]::</span><span class="n">FromHours</span><span class="p">(</span><span class="mf">1</span><span class="p">).</span><span class="py">TotalSeconds</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;command_timeout&#39;</span>         <span class="p">=</span> <span class="mf">120</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;custom_queries&#39;</span>          <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;query&#39;</span>   <span class="p">=</span> <span class="s2">&#34;select count(name) from sys.databases as d where d.Name not in (&#39;master&#39;, &#39;msdb&#39;, &#39;model&#39;, &#39;tempdb&#39;)&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;columns&#39;</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;name&#39;</span> <span class="p">=</span> <span class="s1">&#39;instance.database_count&#39;</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;type&#39;</span> <span class="p">=</span> <span class="s1">&#39;gauge&#39;</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;tags&#39;</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;aws_account_alias:</span><span class="nv">$AWSAccountAlias</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;sql_instance:</span><span class="nv">$SqlInstance</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;stage:</span><span class="nv">$stage</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let me do a quick breakdown, in case you aren&rsquo;t as familiar with this type of syntax in PowerShell.</p>
<ol>
<li><code>$Queries +=</code> takes whatever existing object we have and replaces it with the current object + the new object. This is why it&rsquo;s not performant for large scale work as it&rsquo;s basically creating a whole new copy of the collection with your new addition.</li>
<li>Next, I&rsquo;m using <code>[ordered]</code> instead of <code>[pscustomobject]</code> which in effect does the same thing, but ensures I&rsquo;m not having all my properties randomly sorted each time. Makes things a little easier to review. This is a shorthand syntax for what would be a much longer tedious process using <code>New-Object</code> and <code>Add-Member</code>.</li>
<li>Custom queries is a list, so I cast it with <code>@()</code> format, which tells PowerShell to expect a list. This helps json/yaml conversion be correct even if you have just a single entry. You can be more explicit if you want, like <code>[pscustomobject[]]@()</code> but since PowerShell ignores you mostly on trying to be type specific, it&rsquo;s not worth it. Don&rsquo;t try to make PowerShell be Go or C#. ðŸ˜</li>
</ol>
<h3 id="flip-to-yaml" class="headerLink">
    <a href="#flip-to-yaml" class="header-mark"></a>Flip To Yaml</h3><p>Ok, we have an object list, now we need to flip this to yaml.</p>
<p>It&rsquo;s not as easy as <code>$Queries | yq</code> because of the difference in paradigm with .NET.</p>
<p>We are working with a structured object.</p>
<p>Just look at <code>$Queries | Get-Member</code> and you&rsquo;ll probably get: <code>TypeName: System.Collections.Specialized.OrderedDictionary.</code> The difference is that Go/Linux paradigm is focused on text, not objects. With <code>powershell-yaml</code> module you can run <code>ConvertTo-Yaml $Queries</code> and it will work as it will handle the object transformation.</p>
<p>However, we can actually get there with PowerShell, just need to think of a text focused paradigm instead. This is actually pretty easy using <code>Converto-Json</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$SqlConfig</span> <span class="p">=</span> <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span><span class="s1">&#39;instances&#39;</span> <span class="p">=</span> <span class="nv">$Queries</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$SqlConfig</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="mf">100</span> <span class="p">|</span> <span class="p">&amp;</span><span class="s1">&#39;C:\tools\yq.exe&#39;</span> <span class="n">eval</span> <span class="p">-</span> <span class="p">-</span><span class="n">-prettyPrint</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="nv">$TargetConfig</span> <span class="n">-Encoding</span> <span class="n">UTF8</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This takes the object, converts to json uses the provided cmdlet from PowerShell that knows how to properly take the object and all the nested properties and magically split to <code>JSON</code>.  Pass this into the <code>yq</code> executable, and behold, the magic is done.</p>
<p>You should have a nicely formatted yaml configuration file for Datadog.</p>
<p>If not, the dog will yip and complain with a bunch of red text in the log.</p>
<h3 id="debug-helper" class="headerLink">
    <a href="#debug-helper" class="header-mark"></a>Debug Helper</h3><p>Use this on the remote instance to simplify some debugging, or even connect via SSM directly.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">&amp;</span> <span class="s2">&#34;</span><span class="nv">$env:ProgramFiles</span><span class="s2">\Datadog\Datadog Agent\bin\agent.exe&#34;</span> <span class="n">stopservice</span>
</span></span><span class="line"><span class="cl"><span class="p">&amp;</span> <span class="s2">&#34;</span><span class="nv">$env:ProgramFiles</span><span class="s2">\Datadog\Datadog Agent\bin\agent.exe&#34;</span> <span class="nb">start-service</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#Stream Logs without gui if remote session using:</span>
</span></span><span class="line"><span class="cl"><span class="nb">Get-Content</span> <span class="s1">&#39;C:\ProgramData\Datadog\logs\agent.log&#39;</span> <span class="n">-Tail</span> <span class="mf">5</span> <span class="n">-Wait</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># interactive debugging and viewing of console</span>
</span></span><span class="line"><span class="cl"><span class="c"># &amp; &#34;$env:ProgramFiles\Datadog\Datadog Agent\bin\agent.exe&#34; launch-gui</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="wrap-up" class="headerLink">
    <a href="#wrap-up" class="header-mark"></a>Wrap Up</h2><p>Ideally, use Chef, Ansible, Saltstack, DSC, or another tool to do this. However, sometimes you just need some flexible options for generating this type of content dynamically. Hopefully, you&rsquo;ll find this useful in your PowerShell magician journey and save some time.</p>
<p>I&rsquo;ve already found it useful in flipping json content for various tools back and forth. ðŸŽ‰</p>
<p>A few scenarios that tooling like yq might prove useful could be:</p>
<ul>
<li>convert simple query results from json to yaml and store in git as config</li>
<li>Flip an SSM Json doc to yaml</li>
<li>Review a complex json doc by flipping to yaml for more readable syntax</li>
<li>Confusing co-workers by flipping all their cloudformation from yaml to json or yaml from json. (If you take random advice like this and apply, you probably deserve the aftermath this would bring ðŸ¤£.)</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2025-06-28&nbsp;<a class="git-hash" href="https://github.com/sheldonhull/sheldonhull.hugo/commit/8f8474ab283af2d826741988ccc4429dc8dc7ee4" target="_blank" title="commit by sheldonhull(sheldonhull@users.noreply.github.com) 8f8474ab283af2d826741988ccc4429dc8dc7ee4: feat(ai): create markdown.instructions.md" rel="noopener noreferrer">
                                    <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"/></svg>8f8474a</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line print:!tw-hidden">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/working-with-powershell-objects-to-create-yaml/index.md target="_blank" rel="noopener noreferrer">Read markdown</a>
                    </span></div>
            <div class="post-info-share"><button title="Share on Twitter" data-sharer="twitter" data-url="https://www.sheldonhull.com/working-with-powershell-objects-to-create-yaml/" data-title="Working With Powershell Objects to Create Yaml" data-via="sheldon_hull" data-hashtags="development,tech,powershell,devops"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></button><button title="Share on Linkedin" data-sharer="linkedin" data-url="https://www.sheldonhull.com/working-with-powershell-objects-to-create-yaml/"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg>&nbsp;<a href="/tags/development/">Development</a>,&nbsp;<a href="/tags/tech/">Tech</a>,&nbsp;<a href="/tags/powershell/">Powershell</a>,&nbsp;<a href="/tags/devops/">Devops</a></section>
        <section class="print:!tw-hidden">
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav print:tw-hidden"><a href="/nativefier/" class="prev" rel="prev" title="Nativefier"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>Nativefier</a>
            <a href="/incremental-and-consistent/" class="next" rel="next" title="Incremental and Consistent">Incremental and Consistent<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></a></div>
</div>
<div id="comments"><script
  src="https://giscus.app/client.js"
  data-repo="sheldonhull/sheldonhull.hugo"
  data-repo-id="MDEwOlJlcG9zaXRvcnkxNzcyMzY0MTk="
  data-category="blog"
  data-category-id="DIC_kwDOCpBpw84B-j5B"
  data-mapping="og:title"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-theme="transparent_dark"
  crossorigin="anonymous"
  async
></script>

          <noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
          </noscript></div>
</article></div>
            </main><footer class="footer">
    <div class="footer-container"><div class="footer-line">
        </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2013 -2025</span><span class="author" itemprop="copyrightHolder"
            >&nbsp;<a
              href="/"
              target="_blank"
              rel="noopener noreferrer"
              ></a
            ></span
          >&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreferrer" href="https://www.sheldonhull.com/license" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
      <br />
      <div style="display: flex; justify-content: center;">
        <img src="https://api.netlify.com/api/v1/badges/cc815d05-9008-4078-8e4f-bad42eb3281a/deploy-status" alt="Deployment status" />
      </div>
      <br /><div id="subscribe-footer">
  <form
    action="https://embed.mailbrew.com/api/form_subscribe"
    method="get"
    style="width: 100%; max-width: 340px; color: #dcdcdc; background: #090909; padding: 10px; border-radius: 7px"
    id="mailbrew-embed-form"
  >
    <a
      href="https://app.mailbrew.com/sheldonhull?aff=sheldonhull"
      target="_blank"
      rel="noopener noreferrer"
      style="display: flex; width: 100%; align-items: center; margin-bottom: 6px"
    >
      <img
        src="https://www.gravatar.com/avatar/b909e5a82474e9853ff6a6c6111cf0cf?s=100&amp;d=404&amp;r=g"
        style="width: 22px; height: 22px; border-radius: 22px; margin-right: 6px"
      />
      <span style="font-weight: 500; flex: 1 1 auto; min-width: 0">
        Sheldon Hull
      </span>
    </a>
    <p style="opacity: 0.75; margin-bottom: 4px">
      âš¡ A curated newsletter of my writing and other interesting posts. Mostly
      tech focused.
    </p>
    <div style="display: flex; width: 100%; margin-top: 12px">
      <input
        type="email"
        style="
        height: 32px;
        font-size: 14.5px;
        border-radius: 6px;
        appearance: none;
        padding: 0 8px;
        border: 1px solid rgba(120, 120, 120, 0.3);
        margin-right: 6px;
        flex: 1;
      "
        id="email"
        name="email"
        placeholder="Your email"
        value=""
      />
      <input type="hidden" name="id" value="Ce52fHROTfCr" />
      <button
        type="submit"
        style="
        height: 32px;
        font-size: 14.5px;
        border-radius: 6px;
        appearance: none;
        padding: 0 16px;
        border: none;
        flex: 0 0 auto;
        font-weight: 500;
        cursor: pointer;
        background: #f51616;
        color: white;
      "
      >
        Subscribe
      </button>
    </div>
    <p
      id="mailbrew-success-message"
      style="font-size: 13px; margin-top: 5px; color: green"
    ></p>
    <p
      id="mailbrew-error-message"
      style="font-size: 13px; margin-top: 5px; color: red"
    ></p>
    <a
      href="https://mailbrew.com/?ref=brew-embed&aff=sheldonhull"
      target="_blank"
      rel="noopener noreferrer"
      style="display: block; font-size: 13px; margin-top: 8px; color: rgba(220, 220, 220, 0.6)"
    >
      Made with
      <img
        src="https://www.sheldonhull.com/images/mailbrew-embed-logo.png"
        width="18px"
        height="18px"
        style="margin-bottom: -4px; margin-right: 2px"
      />
      Mailbrew
    </a>
  </form>
</div>
<br /><div>
  <a href="https://www.buymeacoffee.com/KO1AFL2gX" target="_blank">
    <img
      src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png"
      alt="Buy Me A Coffee"
      style="display: inline-block; text-align:center; height: 60px !important;width: 217px !important;"
    />
  </a>
</div>
</div>
  </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><div class="assets"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway&amp;display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material&#43;Icons&amp;display=swap"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"data":{"desktop-header-typeit":"sheldonhull.com","mobile-header-typeit":"sheldonhull.com"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"04HSGXXQD5","algoliaIndex":"sheldonhull.com","algoliaSearchKey":"a7ec2763a5d966a5b9f8d70b254bfb68","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"},"sharerjs":true,"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},"duration":-1,"speed":100}};</script><script
    src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.2/sharer.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"
    
  ></script><script
    src="/js/sidebar.js"
    
  ></script><script src="/js/mailbrew-html-embed-script.js" async></script><script src="//cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/timeago.js/4.0.2/timeago.min.js"></script><script
    src="/js/theme.min.js"
    
      defer
    
  ></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-40198001-3', { 'anonymize_ip': true });
        </script><script
    src="https://www.googletagmanager.com/gtag/js?id=UA-40198001-3"
    async
  ></script></div>

    </body>
</html>