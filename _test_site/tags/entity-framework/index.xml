<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:dc='http://purl.org/dc/elements/1.1/'>
    <channel>
        <title>Entity-Framework - Tag - sheldonhull.com</title>
        <link>https://www.sheldonhull.com/tags/entity-framework/</link>
        <description>Entity-Framework - Tag - sheldonhull.com</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Fri, 18 Mar 2016 00:00:00 &#43;0000</lastBuildDate><atom:link href="https://www.sheldonhull.com/tags/entity-framework/" rel="self" type="application/rss+xml" />

<item>
    <title>
        SQL 2012 SP3 and entity framework conflict
    </title>
    <link>
        https://www.sheldonhull.com/sql-2012-sp3-and-entity-framework-conflict/
    </link>
    <pubDate>
        Fri, 18 Mar 2016 00:00:00 &#43;0000
    </pubDate>
    
    
    <guid>
        https://www.sheldonhull.com/sql-2012-sp3-and-entity-framework-conflict/
    </guid>
    <description>
        <![CDATA[
        
        
        
            
        
        <h2 id="the-problem" class="headerLink">
    <a href="#the-problem" class="header-mark"></a>the problem</h2><p>An issue with SQL Server 2012 SP3 was identified that impacted EF4/5 due to additional datatypes in the dll.</p>
<pre><code>System.EntryPointNotFoundException: Unable to find an entry point named 'SetClrFeatureSwitchMap' in DLL 'SqlServerSpatial110.dll'
</code></pre>
<h2 id="diagnosing" class="headerLink">
    <a href="#diagnosing" class="header-mark"></a>diagnosing</h2><p>To easily identify the available dll versions of sql server, I ran a quick adhoc bat file.</p>
<p><script src="https://gist.github.com/sheldonhull/88ff6ce9caa927a27804.js"></script>

The output returns a simple text file like this:</p>
<p><figure><a class="lightgallery" href="/images/SNAG-0035_pucmdd.jpg" title="/images/SNAG-0035_pucmdd.jpg" data-thumbnail="/images/SNAG-0035_pucmdd.jpg">
        
    </a></figure>
A post in technet mentioned that the DLL shipped with SP3 could cause these conflicts and if the uninstall didn&rsquo;t clean up the GAC correctly, problems could occur with Entity Framework calls.</p>
<blockquote>
<p>Can confirm in my case it was due to dll shipped in SQL Server SP3.  I had to uninstall the patch but the newer dll was still in the gac so I had to overwrite with the older version using gacutil. ( <a href="https://social.technet.microsoft.com/Forums/appvirtualization/en-US/72d07fcb-e3cb-45f1-bff5-abeb13adc5f8/entity-framework-cant-make-updates-in-db-missing-entry-point-setclrfeatureswitchmap-in?forum=sqldataaccess" target="_blank" rel="noopener noreferrer">Edited by snowcow Thursday, January 14, 2016 12:41 PM</a> )</p>
</blockquote>
<h1 id="the-fix" class="headerLink">
    <a href="#the-fix" class="header-mark"></a>The Fix</h1><p>In my case, I still needed the current SP3 version, but we wanted to make sure that the app was pointing to the older version to avoid this error.
I apparently needed to point backwards to:  <code>C:\Windows\assembly\GAC_MSIL\Microsoft.SqlServer.Types\10.0.0.0__89845dcd8080cc91</code>
Stack Overflow, the golden mecca of programming knowledge, saved the day with a solid answer</p>
<blockquote>
<p><a href="http://stackoverflow.com/a/34431276/68698" target="_blank" rel="noopener noreferrer">EF Cannot Update Database</a>
This forces the EntityFramework to use the version 10 of the SqlServer.Types.dll, which doesn&rsquo;t have the Geometry type apparently. - KdBoer
When the fix was applied to map the application config to the older version of the Microsoft.SqlServer.Types.dll (in this case 10). Apparently the 2012 SP3 provided some additional functionality in the dll and this had a conflict with Entity Framework 4 for my situation (and according to online posts EF5 also had some issues)</p>
</blockquote>

        ]]>
    </description>
</item>
</channel>
</rss>
