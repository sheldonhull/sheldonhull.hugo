<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:dc='http://purl.org/dc/elements/1.1/'>
    <channel>
        <title>Dependency-Management - Tag - sheldonhull.com</title>
        <link>https://www.sheldonhull.com/tags/dependency-management/</link>
        <description>Dependency-Management - Tag - sheldonhull.com</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><atom:link href="https://www.sheldonhull.com/tags/dependency-management/" rel="self" type="application/rss+xml" />

<item>
    <title>
        renovate
    </title>
    <link>
        https://www.sheldonhull.com/notes/development/build-release-engineering/renovate/
    </link>
    <pubDate>
        Mon, 01 Jan 0001 00:00:00 &#43;0000
    </pubDate>
    
    
    <guid>
        https://www.sheldonhull.com/notes/development/build-release-engineering/renovate/
    </guid>
    <description>
        <![CDATA[
        
        
        
            
        
        <h2 id="run-locally-via-docker" class="headerLink">
    <a href="#run-locally-via-docker" class="header-mark"></a>Run Locally Via Docker</h2><h3 id="for-azure-devops" class="headerLink">
    <a href="#for-azure-devops" class="header-mark"></a>For Azure DevOps</h3><div
    class="details admonition note
      open
    "
  >
    <div class="details-summary admonition-title">
      <i
        class="icon fas fa-pencil-alt fa-fw"
      ></i>
      Git Safe Directory
      <i class="details-icon fas fa-angle-right fa-fw"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>This doesn&rsquo;t mount to the host <code>/tmp</code>, unlike examples in GitHub, because it asserts the directory as owned by the Docker user (likely root), leading to Git&rsquo;s safe directory feature blocking it.</p>
<p>For this scenario, it&rsquo;s easier to disable mounting to the host because <code>git config --global --add safe.directory /tmp/renovate/repos/*</code> didn&rsquo;t work as expected.</p>
</div>
    </div>
  </div>
<p>Set the environment variables: <code>export AZURE_DEVOPS_ORG=foo</code>, <code>AZURE_DEVOPS_EXT_PAT</code>, and replace <code>PROJECTNAME/REPO</code> as required.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">docker run --rm -it <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">RENOVATE_PLATFORM</span><span class="o">=</span><span class="s2">&#34;azure&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">RENOVATE_ENDPOINT</span><span class="o">=</span><span class="s2">&#34;https://dev.azure.com/</span><span class="si">${</span><span class="nv">AZURE_DEVOPS_ORG</span><span class="si">}</span><span class="s2">/&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">GITHUB_COM_TOKEN</span><span class="o">=</span><span class="k">$(</span>gh auth token<span class="k">)</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">SYSTEM_ACCESSTOKEN</span><span class="o">=</span><span class="nv">$AZURE_DEVOPS_EXT_PAT</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">RENOVATE_TOKEN</span><span class="o">=</span><span class="nv">$AZURE_DEVOPS_EXT_PAT</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">RENOVATE_DRY_RUN</span><span class="o">=</span>full <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">LOG_LEVEL</span><span class="o">=</span>debug <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/config.js:/usr/src/app/config.js <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v /var/run/docker.sock:/var/run/docker.sock <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    renovate/renovate:latest --include-forks<span class="o">=</span><span class="nb">false</span> --dry-run<span class="o">=</span>full PROJECTNAME/REPO
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="centralizing-config" class="headerLink">
    <a href="#centralizing-config" class="header-mark"></a>Centralizing Config</h3><p>Create a <code>config.js</code> in the <code>renovate-config</code> repo you created.
According to the Renovate documentation, this type of config supports NuGet, npm, and GitHub authentication.</p>
<p>Change various options by reviewing the Renovate documentation.
Options like the creation of closed pull requests can be configured by flags or environment variables.</p>
<p>For Azure DevOps Pipelines, see the example below.
For GitHub, consider using the Renovatebot GitHub app for a smoother integration, which also checks the status by default every 3 hours.</p>
<div
    class="details admonition example
      open
    "
  >
    <div class="details-summary admonition-title">
      <i
        class="icon fas fa-list-ol fa-fw"
      ></i>
      local debugging
      <i class="details-icon fas fa-angle-right fa-fw"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># Change recreation if you are testing and need to abandon, then recreate</span>
</span></span><span class="line"><span class="cl">docker run --rm <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -it <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">RENOVATE_RECREATE_CLOSED</span><span class="o">=</span><span class="nb">false</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">LOG_LEVEL</span><span class="o">=</span>debug <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">RENOVATE_DRY_RUN</span><span class="o">=</span><span class="nb">true</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">GITHUB_COM_TOKEN</span><span class="o">=</span><span class="nv">$GITHUB_TOKEN</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -e <span class="nv">RENOVATE_TOKEN</span><span class="o">=</span><span class="nv">$AZURE_DEVOPS_EXT_PAT</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -v <span class="s2">&#34;</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">/config.js:/usr/src/app/config.js&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    renovate/renovate --include-forks<span class="o">=</span><span class="nb">false</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>
<div
    class="details admonition example
      open
    "
  >
    <div class="details-summary admonition-title">
      <i
        class="icon fas fa-list-ol fa-fw"
      ></i>
      config.js
      <i class="details-icon fas fa-angle-right fa-fw"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">pipelineToken</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">RENOVATE_TOKEN</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">patTokenForFeed</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">RENOVATE_TOKEN</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">platform</span><span class="o">:</span> <span class="s1">&#39;azure&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">endpoint</span><span class="o">:</span> <span class="s1">&#39;https://dev.azure.com/{myorg}/&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">token</span><span class="o">:</span> <span class="nx">pipelineToken</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">hostRules</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">hostType</span><span class="o">:</span> <span class="s1">&#39;npm&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">matchHost</span><span class="o">:</span> <span class="s1">&#39;pkgs.dev.azure.com&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;apikey&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">patTokenForFeed</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">hostType</span><span class="o">:</span> <span class="s1">&#39;npm&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">matchHost</span><span class="o">:</span> <span class="s1">&#39;{myorg}.pkgs.visualstudio.com&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;apikey&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">password</span><span class="o">:</span> <span class="nx">patTokenForFeed</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">matchHost</span><span class="o">:</span> <span class="s1">&#39;https://pkgs.dev.azure.com/{myorg}/&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">hostType</span><span class="o">:</span> <span class="s1">&#39;nuget&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;renovate&#39;</span><span class="p">,</span> <span class="c1">// username doesn&#39;t matter for azure
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">password</span><span class="o">:</span> <span class="nx">patTokenForFeed</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">matchHost</span><span class="o">:</span> <span class="s1">&#39;github.com&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">token</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">GITHUB_COM_TOKEN</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">repositories</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// specify format as &#39;Project/reponame&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s1">&#39;Project/reponame&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>
<div
    class="details admonition example
      open
    "
  >
    <div class="details-summary admonition-title">
      <i
        class="icon fas fa-list-ol fa-fw"
      ></i>
      renovate.azure-pipelines.yml
      <i class="details-icon fas fa-angle-right fa-fw"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">renovate.$(Build.Reason)-$(Date:yyyyMMdd)-$(Rev:.r)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">pr</span><span class="p">:</span><span class="w"> </span><span class="l">none</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">trigger</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">batch</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">branches</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">include</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">main</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">schedules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">cron</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">07</span><span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span><span class="l">Mon</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l">Mon7am</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">main]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">always</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">job</span><span class="p">:</span><span class="w"> </span><span class="l">renovate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l">renovate-repos</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">timeoutInMinutes</span><span class="p">:</span><span class="w"> </span><span class="m">15</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pool</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Azure Pipelines</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">vmImage</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">checkout</span><span class="p">:</span><span class="w"> </span><span class="l">self</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">bash</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">          git config --global user.email &#39;bot@renovateapp.com&#39;
</span></span></span><span class="line"><span class="cl"><span class="sd">          git config --global user.name &#39;Renovate Bot&#39;
</span></span></span><span class="line"><span class="cl"><span class="sd">          npx --userconfig .npmrc renovate</span><span class="w">          
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l">npx-renovate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">RENOVATE_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l">$(System.AccessToken)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">GITHUB_COM_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l">$(GITHUB_COM_TOKEN)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>

        ]]>
    <a href="https://brid.gy/publish/twitter"></a>
    <data class="p-bridgy-omit-link" value="false"></data>
    </description>
</item>
</channel>
</rss>
