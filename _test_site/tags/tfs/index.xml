<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:dc='http://purl.org/dc/elements/1.1/'>
    <channel>
        <title>Tfs - Tag - sheldonhull.com</title>
        <link>https://www.sheldonhull.com/tags/tfs/</link>
        <description>Tfs - Tag - sheldonhull.com</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Tue, 07 Mar 2017 00:00:00 &#43;0000</lastBuildDate><atom:link href="https://www.sheldonhull.com/tags/tfs/" rel="self" type="application/rss+xml" />

<item>
    <title>
        TFS Custom Task - Service Actions (for TFS 2015 Update 2.1 or before)
    </title>
    <link>
        https://www.sheldonhull.com/tfs-custom-task-service-actions-for-tfs-2015-update-21-or-before/
    </link>
    <pubDate>
        Tue, 07 Mar 2017 00:00:00 &#43;0000
    </pubDate>
    
    
    <guid>
        https://www.sheldonhull.com/tfs-custom-task-service-actions-for-tfs-2015-update-21-or-before/
    </guid>
    <description>
        <![CDATA[
        
        
        
            
        
        <div
    class="details admonition info
      open
    "
  >
    <div class="details-summary admonition-title">
      <i
        class="icon fas fa-info-circle fa-fw"
      ></i>
      Updated: 2020-04-29
      <i class="details-icon fas fa-angle-right fa-fw"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">broken image links removed</div>
    </div>
  </div>
<p>Apparently, boolean values for custom VSTS tasks for versions prior to TFS 2015 Update 3) require some special handling as they don&rsquo;t pass the checkbox values as actual powershell <code>$true</code> or <code>$false</code>. Instead the task passes this information along as <code>true</code> or <code>false</code>. To properly handle this you&rsquo;ll need to pass in the value as a <code>string</code> then convert to <code>boolean</code>.</p>
<p>I found a great start on working on this solution in a blog post by Rene which has more detail, so <a href="http://bit.ly/2mggrc9" target="_blank" rel="noopener noreferrer">check it out.</a> In addition, some reading on <a href="http://bit.ly/2mgmMnY" target="_blank" rel="noopener noreferrer">promiscuous types</a> with powershell can be helpful to understand why special handling is needed with conversion.
For example, in the task.json file you&rsquo;ll have:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">    <span class="s2">&#34;inputs&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span> <span class="s2">&#34;MyServiceName*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;label&#34;</span><span class="p">:</span> <span class="s2">&#34;ServiceName&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;ServiceName&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;required&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span> <span class="s2">&#34;true&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;helpMarkDown&#34;</span><span class="p">:</span> <span class="s2">&#34;issue restart command&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;label&#34;</span><span class="p">:</span> <span class="s2">&#34;ChangeCredentials&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;ChangeCredentials&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;required&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;boolean&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This boolean value provides a checkbox on the custom task window.</p>
<p>To properly work with the boolean value, you have to bring it in as a script then convert it to a boolean value.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">             <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$ServiceName</span>
</span></span><span class="line"><span class="cl">            <span class="p">,[</span><span class="no">string</span><span class="p">]</span><span class="nv">$ServiceAccount</span>
</span></span><span class="line"><span class="cl">            <span class="p">,[</span><span class="no">string</span><span class="p">]</span><span class="nv">$RestartService</span>
</span></span><span class="line"><span class="cl">            <span class="p">,[</span><span class="no">string</span><span class="p">]</span><span class="nv">$StartService</span>
</span></span><span class="line"><span class="cl">            <span class="p">,[</span><span class="no">string</span><span class="p">]</span><span class="nv">$StopService</span>
</span></span><span class="line"><span class="cl">            <span class="p">,[</span><span class="no">string</span><span class="p">]</span><span class="nv">$ChangeCredentials</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>once you have the parameters, use .NET convert functionality to</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="no">bool</span><span class="p">]</span><span class="nv">$_RestartService</span>    <span class="p">=</span> <span class="p">[</span><span class="no">System.Convert</span><span class="p">]::</span><span class="n">ToBoolean</span><span class="p">(</span><span class="nv">$RestartService</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="no">bool</span><span class="p">]</span><span class="nv">$_StartService</span>      <span class="p">=</span> <span class="p">[</span><span class="no">System.Convert</span><span class="p">]::</span><span class="n">ToBoolean</span><span class="p">(</span><span class="nv">$StartService</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="no">bool</span><span class="p">]</span><span class="nv">$_StopService</span>       <span class="p">=</span> <span class="p">[</span><span class="no">System.Convert</span><span class="p">]::</span><span class="n">ToBoolean</span><span class="p">(</span><span class="nv">$StopService</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="no">bool</span><span class="p">]</span><span class="nv">$_ChangeCredentials</span> <span class="p">=</span> <span class="p">[</span><span class="no">System.Convert</span><span class="p">]::</span><span class="n">ToBoolean</span><span class="p">(</span><span class="nv">$ChangeCredentials</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Below I&rsquo;ve included a custom TFS Task for basic start/stop/restart/change credentials with a custom tfs task. It&rsquo;s not super refined, but it&rsquo;s a good start to get you on your way.</p>
<script src="https://gist.github.com/sheldonhull/622ee7b3da8423b689c9a266816103aa.js"></script>


        ]]>
    <a href="https://brid.gy/publish/twitter"></a>
    <data class="p-bridgy-omit-link" value="false"></data>
    </description>
</item>


<item>
    <title>
        TFS Work-Item Fancy Filtering
    </title>
    <link>
        https://www.sheldonhull.com/tfs-work-item-fancy-filtering/
    </link>
    <pubDate>
        Fri, 18 Mar 2016 00:00:00 &#43;0000
    </pubDate>
    
    
    <guid>
        https://www.sheldonhull.com/tfs-work-item-fancy-filtering/
    </guid>
    <description>
        <![CDATA[
        
        
        
            
        
        <p>If you want to create a TFS query that would identify work items that have changed, but were not changed by the person working it, there is a nifty way to do this.The filtering field can be set to &lt;&gt; another field that is available, but the syntax/setup in Visual Studio is not intuitive. It&rsquo;s in the dropdown list, but I&rsquo;d never noticed it before!</p>
<p><figure><a class="lightgallery" href="/images/SNAG-0037_lmuutc.png" title="filter list" data-thumbnail="/images/SNAG-0037_lmuutc.png">
        
    </a></figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">AND</span><span class="w"> </span><span class="s1">&#39; Changed By &#39;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">Field</span><span class="p">]</span><span class="w"> </span><span class="s1">&#39; Assigned to
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Note that you don&rsquo;t include brackets on the assigned to field, and that the &lt;&gt; [Field] is not a placeholder for you to type the field name in, it&rsquo;s actually the literal command for it to parse this correctly.</p>
<p><figure><a class="lightgallery" href="/images/SNAG-0036_q6zoow.png" title="Filter setup for tfs query" data-thumbnail="/images/SNAG-0036_q6zoow.png">
        
    </a></figure></p>

        ]]>
    <a href="https://brid.gy/publish/twitter"></a>
    <data class="p-bridgy-omit-link" value="false"></data>
    </description>
</item>
</channel>
</rss>
