

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <title>Exploring SQL Server With Powershell And SMO Basics - sheldonhull.com</title><meta name="Description" content="A personal dev blog"><meta property="og:title" content="Exploring SQL Server With Powershell And SMO Basics" />
<meta property="og:description" content="SqlServer Powershell Cmdlets 2017 - Initialize LookDiving into the Sql Server Management Objects library can be a pretty interesting process. You get to work with database objects as in a new way, and begin manipulating and execute code in a much different approach than purely using T-SQL. Powershell offers a unique way to interact with prebuilt cmdlets, and you can explore leveraging .NET in powershell as well to have a powerful toolkit of options." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sheldonhull.com/exploring-sql-server-with-powershell-and-smo-basics/" /><meta property="og:image" content="https://www.sheldonhull.com/images/sheldon-avatar.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-08-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-06-28T13:45:36-05:00" />


<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://www.sheldonhull.com/images/sheldon-avatar.jpg" /><meta name="twitter:title" content="Exploring SQL Server With Powershell And SMO Basics"/>
<meta name="twitter:description" content="SqlServer Powershell Cmdlets 2017 - Initialize LookDiving into the Sql Server Management Objects library can be a pretty interesting process. You get to work with database objects as in a new way, and begin manipulating and execute code in a much different approach than purely using T-SQL. Powershell offers a unique way to interact with prebuilt cmdlets, and you can explore leveraging .NET in powershell as well to have a powerful toolkit of options."/>
<meta name="twitter:site" content="@sheldon_hull"/>
<meta name="application-name" content="sheldonhull.com">
<meta name="apple-mobile-web-app-title" content="sheldonhull.com">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><meta name="twitter:creator" content="@sheldon_hull" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<link rel="canonical" href="https://www.sheldonhull.com/exploring-sql-server-with-powershell-and-smo-basics/" /><link rel="prev" href="https://www.sheldonhull.com/capturing-perfmon-counters-with-telegraf/" /><link rel="next" href="https://www.sheldonhull.com/fixing-virtual-box-only-showing-32bit-windows-os-options/" />
<link rel="stylesheet" href="/css/main.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">{"@context": "https://schema.org","@type": "BlogPosting",
        "headline": "Exploring SQL Server With Powershell And SMO Basics",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://www.sheldonhull.com/exploring-sql-server-with-powershell-and-smo-basics/"
        },"image": ["https://www.sheldonhull.com/images/sheldon-avatar.jpg"],"genre": "posts","keywords":["sql-server","powershell","smo","tech","dbatools"],"wordcount":  1292 ,
        "url": "https://www.sheldonhull.com/exploring-sql-server-with-powershell-and-smo-basics/","datePublished": "2017-08-09T00:00:00+00:00","dateModified": "2025-06-28T13:45:36-05:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https://www.sheldonhull.com/images/sheldon-avatar.jpg"},"author": {
                "@type": "Person",
                "name": "Author",
                "url": "/"
            },"description": ""
    }</script>
    

  
<script src="/jslibs/turbo/v7/index.75da65174eac2f7420dfff4e943b2459d6557d149518d5f6162d08d48842b1e8.js"  integrity="sha256-ddplF06sL3Qg3/9OlDskWdZVfRSVGNX2Fi0I1IhCseg="  defer></script>

        <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "2b4de99e93dc485baaf20c6dffaf78a0"}'></script>
        <link rel="webmention" href="https://webmention.io/www.sheldonhull.com/webmention" />
        <link rel="pingback" href="https://webmention.io/www.sheldonhull.com/xmlrpc" />

    

    <a class="h-card" rel="me" href="https://www.sheldonhull.com/"></a>



</head>
    
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop print:!tw-hidden" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="sheldonhull.com"><img
        class="logo"
        loading="lazy"
        src="/images/sheldon-avatar.jpg"
        srcset="/images/sheldon-avatar.jpg, /images/sheldon-avatar.jpg 1.5x, /images/sheldon-avatar.jpg 2x"
        title="/images/sheldon-avatar.jpg" height="36"   width="36" ><span class="header-title-pre"><span id="logo-anima"><span class="arrow">></span><span class="dash">_</span></span></span><span id="desktop-header-typeit" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item"
                    href="/posts" > posts </a><a class="menu-item"
                    href="/archive" > archive </a><a class="menu-item"
                    href="/about/" > about </a><a class="menu-item"
                    href="/notes/" > notes </a><a class="menu-item"
                    href="/creative/" > creative </a><a class="menu-item"
                    href="/tags/" > tags </a><a class="menu-item"
                    href="https://github.com/sheldonhull/"  title="GitHub" 
                    rel="noopener noreferrer" target="_blank" ><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                    <input type="text"
                        placeholder="Search titles or contents..."
                        id="search-input-desktop">
                    <button class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
                    </button>
                    <button class="search-button search-clear" id="search-clear-desktop" title="Clear">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>
                    </button>
                    <span class="search-button search-loading tw-animate-spin" id="search-loading-desktop">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"/></svg>
                    </span>
                </span><button class="menu-item theme-switch" aria-label="Switch Theme">
                    <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
                </button></div>
        </div>
    </div>
</header><header class="mobile print:!tw-hidden" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="sheldonhull.com"><img
        class="logo"
        loading="lazy"
        src="/images/sheldon-avatar.jpg"
        srcset="/images/sheldon-avatar.jpg, /images/sheldon-avatar.jpg 1.5x, /images/sheldon-avatar.jpg 2x"
        title="/images/sheldon-avatar.jpg" ><span class="header-title-pre"><span id="logo-anima"><span class="arrow">></span><span class="dash">_</span></span></span><span id="mobile-header-typeit" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                <div class="search mobile" id="search-mobile">
                    <input type="text"
                        placeholder="Search titles or contents..."
                        id="search-input-mobile">
                    <button class="search-button search-toggle tw-h-10" id="search-toggle-mobile" title="Search">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
                    </button>
                    <button class="search-button search-clear" id="search-clear-mobile" title="Clear">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>
                    </button>
                    <span class="search-button search-loading tw-animate-spin" id="search-loading-mobile">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"/></svg>
                    </span>
                </div>
                <button class="search-cancel" id="search-cancel-mobile">
                    Cancel
                </button>
            </div><a class="menu-item" href="/posts" title="" >posts</a><a class="menu-item" href="/archive" title="" >archive</a><a class="menu-item" href="/about/" title="" >about</a><a class="menu-item" href="/notes/" title="" >notes</a><a class="menu-item" href="/creative/" title="" >creative</a><a class="menu-item" href="/tags/" title="" >tags</a><a class="menu-item" href="https://github.com/sheldonhull/" title="GitHub" 
                rel="noopener noreferrer" target="_blank" ><i class='fab fa-github fa-fw'></i></a><button class="menu-item theme-switch tw-w-full" aria-label="Switch Theme">
                <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
            </button></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
                <div class="container"><article class="page single h-entry">
    
<a href="https://brid.gy/publish/twitter" style="display: none;"></a>
<h1 class="single-title animated flipInX p-name">Exploring SQL Server With Powershell And SMO Basics</h1><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><a href="/" title="Author" rel=" author" class="author">Author</a>
       </span>&nbsp;
          <span class="post-category">categories <a href=""><i class="far fa-folder fa-fw"></i></a>&nbsp;<a href=""><i class="far fa-folder fa-fw"></i></a></span></div>
      <div class="post-meta-line">
        <a
          rel="author"
          class="p-author h-card"
          style="display: none;"
          ref="https://www.sheldonhull.com/"
        >
          
        </a>
        <span class="u-url" style="display: none;">https://www.sheldonhull.com/exploring-sql-server-with-powershell-and-smo-basics/</span>
        <span class="dt-published" style="display: none;">
          2017-08-09T00:00:00Z
        </span><i class="far fa-calendar-alt fa-fw"></i>
          &nbsp;
          <time datetime="2017-08-09">2017-08-09</time>
          &nbsp;<i class="fas fa-pencil-alt fa-fw"></i>
        &nbsp;1292 words&nbsp;
        <i class="far fa-clock fa-fw"></i>
        &nbsp;7 minutes&nbsp;</div>
    </div>
    


<div class="content e-content" id="content"><h1 id="sqlserver-powershell-cmdlets-2017---initialize-look" class="headerLink">
    <a href="#sqlserver-powershell-cmdlets-2017---initialize-look" class="header-mark"></a>SqlServer Powershell Cmdlets 2017 - Initialize Look</h1><p>Diving into the Sql Server Management Objects library can be a pretty interesting process.
You get to work with database objects as in a new way, and begin manipulating and execute code in a much different approach than purely using T-SQL.
Powershell offers a unique way to interact with prebuilt cmdlets, and you can explore leveraging .NET in powershell as well to have a powerful toolkit of options.
This post is a not focused on a full walk-through, but instead to communicate some of the exploration I&rsquo;ve done, to help if you are beginning to explore more database automation and management.
I plan on doing some basic walk-throughs for the powershell newbie in the future, so if you are confused about anything powershell related feel free to post a comment and I&rsquo;ll add it to my list of stuff to walk through.</p>
<h2 id="cmdlets-vs-net-approach" class="headerLink">
    <a href="#cmdlets-vs-net-approach" class="header-mark"></a>cmdlets vs .NET approach</h2><p>What I&rsquo;ve found interesting is there are really 2 main approaches to interacting with SQL Server.
You can directly invoke the SMO dlls and access the methods, properties, and extensibility this offers.
This requires more .NET knowledge as you would be directly working with the SMO namespace, in a way that is almost the same as what you code in C#. The other approach is to leverage cmdlets.
The cmdlets try to abstract away a lot of the complexities that working directly with the SMO namespace for ease of use and automation, and to simplify the process for those not as comfortable with coding in C# or directly leverage the SMO namespace in C#</p>
<p>If purely focused on automation and little experience working with .NET then <strong>cmdlet&rsquo;s</strong> will be by far the way to go.
There is a serious learning curve in working with .NET directly vs prebuilt cmdlets.
If desiring to expand your .NET knowledge, as well find that the prebuilt cmdlets don&rsquo;t offer the behavior you are trying to achieve, then exploring the SMO namespace for directly invoking the methods and accessing properties can be valuable.
The learning curve is more intense, so just be prepared for that if you are new to working with .NET directly in Powershell.</p>
<h2 id="dbatoolsio--other-sources" class="headerLink">
    <a href="#dbatoolsio--other-sources" class="header-mark"></a>dbatools.io &amp; other sources</h2><p>When possible, I personally am going to recommend to leverage a package like dbatools instead of rolling your own.
Dbatools.io is a powerful project that I&rsquo;ve recently begun to explore more.
This well rounded package gives you a powerful powershell set of commands that can help you set server properties, obtain default paths, backup, restore, migrate entire sets of databases to a new location and more.
To code all of this from scratch would be a massive project.
I&rsquo;d recommend considering dbatools.io and just getting involved in that project if you have something to contribute.
I found it really helpful to quickly setup some default server options without having to configure manually myself.</p>
<h2 id="exploring-sql-path-provider" class="headerLink">
    <a href="#exploring-sql-path-provider" class="header-mark"></a>Exploring SQL Path Provider</h2><p>Trying to find the path initially can be challenging.
However, by opening SSMS up, right clicking, and launching the powershell window you&rsquo;ll be able to easily find the correct path to get the server level object.
This allows you to leverage default methods in powershell like Get-ChildItem for iterating through objects.
It treats the navigated SQL server path basically as a &ldquo;file structure&rdquo; allowing some interesting actions to be performed.
One of these is a different approach to killing connections to a particular database.
I found this great pointer by reading <a href="http://www.midnightdba.com/DBARant/killing-spids-in-powershell/" target="_blank" rel="noopener noreferrer">Killing SPIDS in Powershell</a> from MidnightDBA</p>
<p>Review that article for scripts focused on the termination of running spids.
For an adhoc purpose the scripts MidnightDba provided are excellent and would allow quickly executing a kill script on connections from ssms &gt; powershell prompt.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">import-module</span> <span class="n">-name</span> <span class="n">sqlserver</span> <span class="n">-disablenamechecking</span> <span class="n">-verbose:</span><span class="vm">$false</span> <span class="n">-debug:</span><span class="vm">$false</span>
</span></span><span class="line"><span class="cl"><span class="nb">CD </span><span class="n">SQLSERVER</span><span class="err">:</span><span class="p">\</span><span class="n">SQL</span><span class="p">\</span><span class="nv">$ServerName</span> <span class="n">-Verbose:</span><span class="vm">$false</span> <span class="n">-Debug:</span><span class="vm">$false</span>
</span></span><span class="line"><span class="cl"><span class="nb">dir </span><span class="s1">&#39; ?{$_.Name -eq &#34;$DatabaseName&#34;} &#39;</span> <span class="p">%{</span><span class="nv">$_</span><span class="p">.</span><span class="py">KillAllProcesses</span><span class="p">(</span><span class="nv">$DatabaseName</span><span class="p">)}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>I approach this with a different method in one final script using just the SMO server method KillAllProcesses.
For some tasks I&rsquo;ve found it really helpful to have a simple 1 line kill statement thanks to MidnightDba&rsquo;s pointer with the statements similar to the one above.
Using Microsoft&rsquo;s documented method shows another example of how to use to restart the service.
This was one modified approach I took.
I prefer not to use this type of approach as working with <code>get-childitem</code> with server objects to me as a little unintuitive.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">        .LINK https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services#PowerShellProcedure
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$ErrorActionPreference</span> <span class="p">=</span> <span class="s1">&#39;continue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-InstalledModule</span> <span class="n">SqlServer</span><span class="p">))</span> <span class="p">{</span> <span class="nb">install-package</span> <span class="n">SqlServer</span> <span class="n">-scope</span> <span class="n">CurrentUser</span> <span class="n">-verbose:</span><span class="vm">$false</span> <span class="n">-Force</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="no">datetime</span><span class="p">]</span><span class="nv">$StepTimer</span> <span class="p">=</span> <span class="p">[</span><span class="no">datetime</span><span class="p">]::</span><span class="n">Now</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$private:ServerName</span> <span class="p">=</span> <span class="nv">$env:ServerName</span>
</span></span><span class="line"><span class="cl"><span class="nb">import-module</span> <span class="n">-name</span> <span class="n">sqlserver</span> <span class="n">-disablenamechecking</span> <span class="n">-verbose:</span><span class="vm">$false</span> <span class="n">-debug:</span><span class="vm">$false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Get a reference to the ManagedComputer class.</span>
</span></span><span class="line"><span class="cl"><span class="nb">CD </span><span class="n">SQLSERVER</span><span class="err">:</span><span class="p">\</span><span class="n">SQL</span><span class="p">\</span><span class="nv">$private:ServerName</span> <span class="n">-Verbose:</span><span class="vm">$false</span> <span class="n">-Debug:</span><span class="vm">$false</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Wmi</span> <span class="p">=</span> <span class="p">(</span><span class="nb">get-item</span> <span class="n">-debug:</span><span class="vm">$false</span> <span class="n">-verbose:</span><span class="vm">$false</span> <span class="p">.).</span><span class="py">ManagedComputer</span>
</span></span><span class="line"><span class="cl"><span class="nv">$DfltInstance</span> <span class="p">=</span> <span class="nv">$Wmi</span><span class="p">.</span><span class="n">Services</span><span class="p">[</span><span class="s1">&#39;MSSQLSERVER&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#Display the state of the service.</span>
</span></span><span class="line"><span class="cl"><span class="nb">write-host</span> <span class="s2">&#34;Stopping Instance: </span><span class="p">$(</span><span class="nv">$DfltInstance</span><span class="p">.</span><span class="py">ServiceState</span><span class="p">.</span><span class="n">value__</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$DfltInstance</span><span class="p">.</span><span class="py">Stop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="nv">$DfltInstance</span><span class="p">.</span><span class="py">ServiceState</span><span class="p">.</span><span class="py">value__</span> <span class="o">-ne</span> <span class="mf">1</span><span class="p">)</span> <span class="c">#1 stopped</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Start-Sleep</span> <span class="n">-seconds</span> <span class="mf">5</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$DfltInstance</span><span class="p">.</span><span class="py">Refresh</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;... state: </span><span class="p">$(</span><span class="nv">$DfltInstance</span><span class="p">.</span><span class="n">ServiceState</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c">## Start the service.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$DfltInstance</span><span class="p">.</span><span class="py">Refresh</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">write-host</span> <span class="s2">&#34;Current Service State: </span><span class="p">$(</span><span class="nv">$DfltInstance</span><span class="p">.</span><span class="n">ServiceState</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">write-host</span> <span class="s2">&#34;Initiating Service Start&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$DfltInstance</span><span class="p">.</span><span class="py">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="nv">$DfltInstance</span><span class="p">.</span><span class="py">ServiceState</span><span class="p">.</span><span class="py">value__</span> <span class="o">-ne</span> <span class="mf">4</span><span class="p">)</span> <span class="c">#4 running</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Start-Sleep</span> <span class="n">-seconds</span> <span class="mf">5</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$DfltInstance</span><span class="p">.</span><span class="py">Start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$DfltInstance</span><span class="p">.</span><span class="py">Refresh</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">write-host</span> <span class="s2">&#34;... state: </span><span class="p">$(</span><span class="nv">$DfltInstance</span><span class="p">.</span><span class="n">ServiceState</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">write-host</span><span class="p">(</span> <span class="s2">&#34;{0:hh\:mm\:ss\.fff} {1}: finished&#34;</span> <span class="o">-f</span> <span class="p">[</span><span class="no">timespan</span><span class="p">]::</span><span class="n">FromMilliseconds</span><span class="p">(((</span><span class="nb">Get-Date</span><span class="p">)-</span><span class="nv">$StepTimer</span><span class="p">).</span><span class="n">TotalMilliseconds</span><span class="p">),</span><span class="s1">&#39;SQL Service Restart&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="database-as-an-object" class="headerLink">
    <a href="#database-as-an-object" class="header-mark"></a>Database as an Object</h2><p>Getting the database as an object proved to be easy though, if a little confusing to navigate initially.
$s = SqlServer\Get-SqlDatabase -ServerInstance $ServerInstance -Verbose</p>
<p>Once the object is obtained, you can begin scripting objects, change database properties and more very easily.
I found this method an interesting alternative to invoking using .NET accelerators as it was a quick way to easily get a database level object to work with.
However, some of the limitations of not having the server level object immediately available made me end up preferring the .NET accelerator version which could look like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$ServerName</span> <span class="p">=</span> <span class="s1">&#39;localhost&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">,</span><span class="nv">$DatabaseName</span> <span class="p">=</span> <span class="s1">&#39;tempdb&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$s</span> <span class="p">=</span> <span class="p">[</span><span class="no">Microsoft.SqlServer.Management.Smo.Server</span><span class="p">]::</span><span class="n">New</span><span class="p">(</span><span class="nv">$ServerName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$d</span> <span class="p">=</span> <span class="p">[</span><span class="no">Microsoft.SqlServer.Management.Smo.Database</span><span class="p">]::</span><span class="n">New</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$DatabaseName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$s</span><span class="p">.</span><span class="py">EnumProcesses</span><span class="p">()</span> <span class="s1">&#39; format-table -AutoSize
</span></span></span><span class="line"><span class="cl"><span class="s1">$d.EnumObjects() &#39;</span> <span class="nb">Out-GridView</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Interestingly, to actually access the many of the database properties you actually would call it via reference to the server object with SMO calls instead of the cmdlet.
Trying $d.PrimaryFilePath doesn&rsquo;t work as I believe it&rsquo;s initiating the instance of a new database object for creation instead of referencing the initialization of a new object to an existing database.
I found documentation a bit challenging to immediately sift through to get an answer, so YMMV.
Someone coming from a .NET focused background might find the process a little more clear, but for me it did take some work to correctly identify the behavior.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">#doesn&#39;t work.</span>
</span></span><span class="line"><span class="cl"><span class="n">Probably</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">initialize</span> <span class="n">new</span> <span class="n">object</span> <span class="k">for</span> <span class="n">creating</span> <span class="n">a</span> <span class="n">db</span>
</span></span><span class="line"><span class="cl"><span class="nv">$d</span> <span class="p">=</span> <span class="p">[</span><span class="no">Microsoft.SqlServer.Management.Smo.Database</span><span class="p">]::</span><span class="n">New</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$db</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$d</span><span class="p">.</span><span class="py">PrimaryFilePath</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#works to access current existing object</span>
</span></span><span class="line"><span class="cl"><span class="nv">$s</span><span class="p">.</span><span class="n">Databases</span><span class="p">[</span><span class="nv">$db</span><span class="p">].</span><span class="py">PrimaryFilePath</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="exploring-properties" class="headerLink">
    <a href="#exploring-properties" class="header-mark"></a>Exploring Properties</h3><p>If you want to explore properties of an object, try using the ever faithful get-member</p>
<p>Depending on the type of object, you can additionally explore them with GetEnumerator, GetProperties, etc.
You&rsquo;ll find intellisense helpful as you explore more.
For instance, here&rsquo;s a walkthrough on the various ways you might explore the object and find you need to dig into it to get the full detail of what you have access to.
<script src="https://gist.github.com/sheldonhull/e3ed8534b1565c67d6d59163b0921d59.js"></script>
</p>
<h2 id="comparing-restoring-a-database-with-cmdlet-vs-smo" class="headerLink">
    <a href="#comparing-restoring-a-database-with-cmdlet-vs-smo" class="header-mark"></a>Comparing Restoring a Database with Cmdlet vs SMO</h2><h3 id="using-dbatools-cmdlet" class="headerLink">
    <a href="#using-dbatools-cmdlet" class="header-mark"></a>using dbatools cmdlet</h3><p>An example of how simple using dbatools cmdlet can make restoring a database copy</p>
<script src="https://gist.github.com/sheldonhull/7314ffa3fc830f36a2eda8ee7e27f7c4.js"></script>

<h3 id="rolling-your-own-wheel" class="headerLink">
    <a href="#rolling-your-own-wheel" class="header-mark"></a>rolling your own wheel</h3><p>Now compare this to the complexity of running your own invocation of the SMO namespace and requires a lot more coding.
Since dbatools wraps up a lot of the functionality, I&rsquo;ve actually migrated to leveraging this toolkit for these dba related tasks instead of trying to reinvent the wheel.
<script src="https://gist.github.com/sheldonhull/08fe28dd236a239f25821378268ef8e5.js"></script>
</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2025-06-28&nbsp;<a class="git-hash" href="https://github.com/sheldonhull/sheldonhull.hugo/commit/8f8474ab283af2d826741988ccc4429dc8dc7ee4" target="_blank" title="commit by sheldonhull(sheldonhull@users.noreply.github.com) 8f8474ab283af2d826741988ccc4429dc8dc7ee4: feat(ai): create markdown.instructions.md" rel="noopener noreferrer">
                                    <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"/></svg>8f8474a</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line print:!tw-hidden">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/exploring-sql-server-with-powershell-and-smo-basics/index.md target="_blank" rel="noopener noreferrer">Read markdown</a>
                    </span></div>
            <div class="post-info-share"><button title="Share on Twitter" data-sharer="twitter" data-url="https://www.sheldonhull.com/exploring-sql-server-with-powershell-and-smo-basics/" data-title="Exploring SQL Server With Powershell And SMO Basics" data-via="sheldon_hull" data-hashtags="sql-server,powershell,smo,tech,dbatools"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></button><button title="Share on Linkedin" data-sharer="linkedin" data-url="https://www.sheldonhull.com/exploring-sql-server-with-powershell-and-smo-basics/"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg>&nbsp;<a href="/tags/sql-server/">Sql-Server</a>,&nbsp;<a href="/tags/powershell/">Powershell</a>,&nbsp;<a href="/tags/smo/">Smo</a>,&nbsp;<a href="/tags/tech/">Tech</a>,&nbsp;<a href="/tags/dbatools/">Dbatools</a></section>
        <section class="print:!tw-hidden">
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav print:tw-hidden"><a href="/capturing-perfmon-counters-with-telegraf/" class="prev" rel="prev" title="Capturing Perfmon Counters With Telegraf"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>Capturing Perfmon Counters With Telegraf</a>
            <a href="/fixing-virtual-box-only-showing-32bit-windows-os-options/" class="next" rel="next" title="Fixing VirtualBox Only Showing 32bit Windows OS Options">Fixing VirtualBox Only Showing 32bit Windows OS Options<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></a></div>
</div>
<div id="comments">







<div class="webmentions" id="webmentions" style="width:90% !important;">
  
  
  
  
  

  
  
  
  

  <br>

  
  
    
    
      
      
    
  
  <h3>Webmentions</h3>


  
    
    
    
    
    
        <summary class="h4">Likes&nbsp;&nbsp;<span class="legal" style="font-weight: normal;">(1)</span></summary>
        <ul class="webmentions__list_facepile">
        
          <li><a href="https://twitter.com/sheldon_hull/status/1454242331012575233#favorited-by-161137627" class="u-url">
          <img class="webmention__author__photo u-photo" src="https://webmention.io/avatar/pbs.twimg.com/240f52c99c0f799e1973b130bbb725f84989770249acb921b3ca1d8de0e50849.jpg" alt="Marc-AndrÃ© Moreau"></a>
          </li>
        
        </ul>
    

    

    

    

    
</div>


<script
  src="https://giscus.app/client.js"
  data-repo="sheldonhull/sheldonhull.hugo"
  data-repo-id="MDEwOlJlcG9zaXRvcnkxNzcyMzY0MTk="
  data-category="blog"
  data-category-id="DIC_kwDOCpBpw84B-j5B"
  data-mapping="og:title"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-theme="transparent_dark"
  crossorigin="anonymous"
  async
></script>

          <noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
          </noscript></div>
</article></div>
            </main><footer class="footer">
    <div class="footer-container"><div class="footer-line">
        </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2013 -2025</span><span class="author" itemprop="copyrightHolder"
            >&nbsp;<a
              href="/"
              target="_blank"
              rel="noopener noreferrer"
              ></a
            ></span
          >&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreferrer" href="https://www.sheldonhull.com/license" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
      <br />
      <div style="display: flex; justify-content: center;">
        <img src="https://api.netlify.com/api/v1/badges/cc815d05-9008-4078-8e4f-bad42eb3281a/deploy-status" alt="Deployment status" />
      </div>
      <br /><div id="subscribe-footer">
  <form
    action="https://embed.mailbrew.com/api/form_subscribe"
    method="get"
    style="width: 100%; max-width: 340px; color: #dcdcdc; background: #090909; padding: 10px; border-radius: 7px"
    id="mailbrew-embed-form"
  >
    <a
      href="https://app.mailbrew.com/sheldonhull?aff=sheldonhull"
      target="_blank"
      rel="noopener noreferrer"
      style="display: flex; width: 100%; align-items: center; margin-bottom: 6px"
    >
      <img
        src="https://www.gravatar.com/avatar/b909e5a82474e9853ff6a6c6111cf0cf?s=100&amp;d=404&amp;r=g"
        style="width: 22px; height: 22px; border-radius: 22px; margin-right: 6px"
      />
      <span style="font-weight: 500; flex: 1 1 auto; min-width: 0">
        Sheldon Hull
      </span>
    </a>
    <p style="opacity: 0.75; margin-bottom: 4px">
      â¡ A curated newsletter of my writing and other interesting posts. Mostly
      tech focused.
    </p>
    <div style="display: flex; width: 100%; margin-top: 12px">
      <input
        type="email"
        style="
        height: 32px;
        font-size: 14.5px;
        border-radius: 6px;
        appearance: none;
        padding: 0 8px;
        border: 1px solid rgba(120, 120, 120, 0.3);
        margin-right: 6px;
        flex: 1;
      "
        id="email"
        name="email"
        placeholder="Your email"
        value=""
      />
      <input type="hidden" name="id" value="Ce52fHROTfCr" />
      <button
        type="submit"
        style="
        height: 32px;
        font-size: 14.5px;
        border-radius: 6px;
        appearance: none;
        padding: 0 16px;
        border: none;
        flex: 0 0 auto;
        font-weight: 500;
        cursor: pointer;
        background: #f51616;
        color: white;
      "
      >
        Subscribe
      </button>
    </div>
    <p
      id="mailbrew-success-message"
      style="font-size: 13px; margin-top: 5px; color: green"
    ></p>
    <p
      id="mailbrew-error-message"
      style="font-size: 13px; margin-top: 5px; color: red"
    ></p>
    <a
      href="https://mailbrew.com/?ref=brew-embed&aff=sheldonhull"
      target="_blank"
      rel="noopener noreferrer"
      style="display: block; font-size: 13px; margin-top: 8px; color: rgba(220, 220, 220, 0.6)"
    >
      Made with
      <img
        src="https://www.sheldonhull.com/images/mailbrew-embed-logo.png"
        width="18px"
        height="18px"
        style="margin-bottom: -4px; margin-right: 2px"
      />
      Mailbrew
    </a>
  </form>
</div>
<br /><div>
  <a href="https://www.buymeacoffee.com/KO1AFL2gX" target="_blank">
    <img
      src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png"
      alt="Buy Me A Coffee"
      style="display: inline-block; text-align:center; height: 60px !important;width: 217px !important;"
    />
  </a>
</div>
</div>
  </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><div class="assets"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway&amp;display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material&#43;Icons&amp;display=swap"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"data":{"desktop-header-typeit":"sheldonhull.com","mobile-header-typeit":"sheldonhull.com"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"04HSGXXQD5","algoliaIndex":"sheldonhull.com","algoliaSearchKey":"a7ec2763a5d966a5b9f8d70b254bfb68","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"},"sharerjs":true,"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},"duration":-1,"speed":100}};</script><script
    src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.2/sharer.min.js"
    
  ></script><script
    src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"
    
  ></script><script
    src="/js/sidebar.js"
    
  ></script><script
    src="/js/webmentions.js"
    
  ></script><script src="/js/mailbrew-html-embed-script.js" async></script><script src="//cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/timeago.js/4.0.2/timeago.min.js"></script><script
    src="/js/theme.min.js"
    
      defer
    
  ></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-40198001-3', { 'anonymize_ip': true });
        </script><script
    src="https://www.googletagmanager.com/gtag/js?id=UA-40198001-3"
    async
  ></script></div>

    </body>
</html>